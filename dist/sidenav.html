{%- if theme_homepath|length %}
  {%- set home_path = theme_homepath %}
{%- else %}
  {%- set home_path = pathto(master_doc) %}
{%- endif %}

<nav data-toggle="wy-nav-shift" class="wy-nav-side">
  <div class="wy-side-scroll">
    <div class="wy-side-nav-head" {% if theme_style_nav_header_background %} style="background: {{theme_style_nav_header_background}}" {% endif %}>
      {% if pagename != 'index' or theme_home_sidebartitle %}
      {% block sidebartitle %}
        <a href="{{ home_path }}" title="{{ project }}" alt="{{ _('Documentation Home') }}"
        {% if not (logo and theme_logo_only) %}
        class="icon icon-home"> {{ project }}
        {% else %}
        >
        {% endif %}
        {% if logo %}
          {# Not strictly valid HTML, but it's the only way to display/scale it properly, without weird scripting or heaps of work #}
          <img src="{{ pathto('_static/' + logo, 1) }}" class="logo" alt="{{ _('Logo') }}"/>
        {% endif %}
        </a>
        {% if theme_display_version %}
          <div class="version" ><a href="{{ pathto(master_doc) }}">{{ version }}</a></div>
        {% endif %}
      {% endblock %}
      {% endif %}
    </div>
    {% include "searchbox.html" %}
    {% block navigation %}
      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        {% block menu %}
          {# The singlehtml builder doesn't handle this toctree call when the toctree is empty. Skip building this for now. #}
          {% if 'singlehtml' not in builder %}
            {% set global_toc = toctree(
              maxdepth=theme_navigation_depth|int,
              collapse=theme_collapse_navigation|tobool,
              includehidden=theme_includehidden|tobool,
              titles_only=theme_titles_only|tobool
            ) %}
          {% endif %}
          {% if global_toc %}
            {{ global_toc }}
          {% else %}
            <div class="local-toc">{{ toc }}</div>
          {% endif %}
        {% endblock %}
      </div>
    {% endblock %}
    <div class="wy-side-meta">
    {%- if show_sphinx %}
      <div class="wy-side-meta-pre"></div>
      <hr>
      <div class="wy-side-meta-content">
        {% trans %}Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/buildthedocs/sphinx_btd_theme">theme</a> provided by <a href="https://github.com/buildthedocs">Build the Docs</a>{% endtrans %}.
      </div>
    {%- endif %}
    </div>
  </div>
</nav>
